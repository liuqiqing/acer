$(function () {
    getycsjsl();
    getycsjlb();
    getycsjqs();
})
// 一窗收件事项弹出框：下载
function qxZyQkDownload(){
    window.location.href = ctx + "/tyslcontroller/downloadsxlb";
}
// 获取当天的一窗收件数量
function getycsjsl() {
    var ycsjsl = ctx + "/tyslcontroller/getycsjsl";
    var arr = new Array();
    $.ajax({
        type: "get",
        async: true,
        url: ycsjsl,
        success: function (result) {
            $("#total_count").html(result.ycsjsl);
            $("#sum_success_times").html(0);
            $("#sum_failed_times").html(result.ycsjsl);
        },
        error: function (error) {

        }
    })
}

// 获取一窗收件事项排名
function getycsjlb() {
    var ycsjlb = ctx + "/tyslcontroller/getycsjlb";
    var arr = new Array();
    $.ajax({
        type: "get",
        async: true,
        url: ycsjlb,
        data: {
            "page": 15
        },
        success: function (result) {
            //console.log(result)
            if (result.ycsjlb.length > 0) {
                var qxHtml = "";
                for (var i = 0; i < result.ycsjlb.length; i++) {
                    qxHtml += "<tr>";
                    qxHtml += "<td style='width: 60px;'>" + (i + 1) + "</td>";
                    qxHtml += "<td width='300px' title='" + result.ycsjlb[i].ITEM_NAME + "' style='display: block;overflow: hidden;text-overflow:ellipsis;white-space: nowrap;'>" + result.ycsjlb[i].ITEM_NAME + "</td>"; // 事项名称
                    qxHtml += "<td width='120px'>" + result.ycsjlb[i].TYPE + "</td>"; // 事项类型
                    qxHtml += "<td width='120px'>" + result.ycsjlb[i].REGION_NAME + "</td>"; // 收件区域
                    qxHtml += "<td width='120px'>" + result.ycsjlb[i].STATE + "</td>"; // 时间
                    qxHtml += "<td width='150px'>" + result.ycsjlb[i].SUBMIT_TIME + "</td>"; // 时间
                    qxHtml += "</tr>";
                }
                $("#body-lb").html(qxHtml)
            } else {
                $("#body-lb").html("暂无数据")
            }
        },
        error: function (error) {

        }
    })
}


// 获取一窗收件一周的数量变化趋势
function getycsjqs() {
    var ycsjqs = ctx + "/tyslcontroller/getycsjqs";
    var arr = new Array();
    $.ajax({
        type: "get",
        async: true,
        url: ycsjqs,
        success: function (result) {
            //console.log(result.ycsjqs);
            var arr = new Array();
            var arrs = new Array()
            for (var i = 0; i < result.ycsjqs.length; i++) {
                arr.push(result.ycsjqs[i].TIME);
                arrs.push(result.ycsjqs[i].SUM);
            }
            var chart3 = echarts.init(document.getElementById('chart3'));
            chart3.setOption({
                title: {
                    text: '一窗收件变化趋势',
                    textStyle: {
                        color: '#fff',
                    },
                },
                grid: {
                    top: '10%',
                    left: 0,
                    right: 0,
                    bottom: 0,
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    data:arr.reverse() ,
                    axisLabel: {
                        interval: 0,
                        rotate: 30,
                        textStyle: {
                            color: '#e5f8ff'
                        }
                    },
                    axisLine: {
                        lineStyle: {
                            color: '#42456a'
                        }
                    }
                },
                yAxis: {
                    type: 'value',
                    axisLine: {
                        show: false
                    },
                    axisLabel: {
                        textStyle: {
                            color: '#e5f8ff'
                        }
                    },
                    splitLine: {
                        lineStyle: {
                            type: 'dashed',
                            color: '#2e3450',
                        }
                    }
                },
                legend: {
                    data: ['收件数'],
                    right: 0,
                    itemGap: 10,
                    textStyle: {
                        color: '#e5f8ff'
                    }
                },
                tooltip: {
                    trigger: 'axis',
                    axisPointer: {
                        type: 'line'
                    }
                },
                series: [{
                    type: 'line',
                    name: '受理',
                    data: arrs.reverse(),
                    color: '#0094fb',
                }]
            })

        },
        error: function (error) {

        }
    })
}